# 实现聊天室的方式有哪些

## java多线程+socket

### tcp

TCP协议是面向连接的、可靠的、有序的、以字节流的方式发送数据，通过三次握手方式建立连接，形成传输数据的通道，在连接中进行大量数据的传输，效率会稍低

**Socket通信的步骤**

​                 ① 创建ServerSocket和Socket

​                 ② 打开连接到Socket的输入/输出流

​                 ③ 按照协议对Socket进行读/写操作

​                 ④ 关闭输入输出流、关闭Socket

**服务器端：**

​                 ① 创建ServerSocket对象，绑定监听端口

​                 ② 通过accept()方法监听客户端请求

​                 ③ 连接建立后，通过输入流读取客户端发送的请求信息

​                 ④ 通过输出流向客户端发送乡音信息

​                 ⑤ 关闭相关资源

**客户端：**

​                 ① 创建Socket对象，指明需要连接的服务器的地址和端口号

​                 ② 连接建立后，通过输出流想服务器端发送请求信息

​                 ③ 通过输入流获取服务器响应的信息

​                 ④ 关闭响应资源 

### udp

UDP协议（用户数据报协议）是无连接的、不可靠的、无序的,速度快

**1、服务器端实现步骤**

​           ① 创建DatagramSocket，指定端口号

​           ② 创建DatagramPacket

​           ③ 接受客户端发送的数据信息

​           ④ 读取数据**

**2、客户端实现步骤**

​           ① 定义发送信息

​           ② 创建DatagramPacket，包含将要发送的信息

​           ③ 创建DatagramSocket

​           ④ 发送数据

## websocket

先比较正常的HTTP请求和websocket通信，

正常情况：页面所在web服务器发送一个HTTP请求。web服务器识别请求，然后返回响应。轮询便是定时发送HTTP请求，有时候并不能达到实时通讯。

长连接原理跟轮询差不多，都是采用轮询的方式，不过采取的是阻塞模型，客户端发起连接后，如果没消息，就一直不返回Response给客户端。直到有消息才返回，返回完之后，客户端再次建立连接，周而复始。这样加大了服务器的压力。

> 而websocket提供了双向的、按序到达的数据流，一但连接成功，就可以在全双工模式下在客户端和服务器之间来回传送websocket消息。

wesocket的优点如下：

1、服务器与客户端之间交换的标头信息很小。

2、客户端与服务器都可以主动传送数据给对方。

3、不用频率创建TCP请求及销毁请求，减少网络宽带资源的占用，同时也节省服务器资源。

数据库+定时刷新

每次刷新都是一次tcp请求

# 目录树的表结构

<https://www.cnblogs.com/kissdodog/p/3297894.html>



# redis性能分析

# java的异步操作

创建线程去操作（future）。mq。

